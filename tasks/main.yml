---
# tasks file for jenkins-centos
# https://wiki.jenkins-ci.org/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions
- name: Install JDK
  yum:
    name: "{{ jenkins_jdk }}"
    update_cache: yes
  when: jenkins_jdk != "no" and jenkins_jdk
- name: Add repository
  get_url:
    url: http://pkg.jenkins-ci.org/redhat/jenkins.repo
    dest: /etc/yum.repos.d/jenkins.repo
- name: Add jenkins-ci.org.key
  rpm_key:
    key: https://jenkins-ci.org/redhat/jenkins-ci.org.key
- name: Install jenkins
  yum:
    name: jenkins
    update_cache: yes
- name: Change jenkins state
  service:
    name: jenkins
    state: "{{ jenkins_state }}"
  when: jenkins_state != "no" and jenkins_state
- name: Change whether the service should start on boot
  service:
    name: jenkins
    enabled: "{{ jenkins_enabled }}"
  when: jenkins_enabled != "default"
